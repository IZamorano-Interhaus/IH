<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="report_journal_entry_document">
        <t t-call="web.external_layout">
            <t t-set="registro" t-value="registro.with_context(lang=lang)" />
            <div class="page">
                <h2>LIBRO DE COMPRAS</h2>
                <div class="row">
                    <table name='lines_content' class="table table-sm registro_main_table">
                        <thead>
                            <tr>
                                <th name="th_type_doc" class="text-left">Tipo de Documento</th>
                                <th name="th_folio" class="text-left">Folio</th>
                                <th name="th_rut" class="text-left">RUT NÂº</th>
                                <th name="th_partner" class="text-left">Partner</th>
                                <th name="th_date" class="text-left">Fecha de Factura/Recibo</th>
                                <th name="th_afecto" class="text-left">Monto Afecto</th>
                                <th name="th_exento" class="text-left">Monto Exento</th>
                                <th name="th_total" class="text-left">Total</th>
                                
                            </tr>
                        </thead>
                        <tbody>
                             <t t-foreach="registro" t-as="line">
                                <tr >
                                    <!-- DOC TYPE-->
                                    <td name='tb_doc_type'>
                                        <span t-field="line.l10n_latam_document_type_id" />
                                    </td>

                                    <!-- FOLIO-->
                                    <td name='tb_folio'>
                                        <span t-field="line.l10n_latam_document_number" />
                                    </td>
                                    
                                    <!-- RUT-->
                                    <td name='tb_rut'>
                                        <span t-field="line.partner_id.vat" />
                                    </td>
                                    
                                    <!-- PARTNER-->
                                     <td name='tb_partner'>
                                        <span t-field="line.partner_id.name" />
                                    </td>

                                     <!-- DATE-->
                                    <td name='tb_date'>
                                         <span t-field="line.invoice_date_due" />
                                    </td>
                                    
                                    <!-- AFECTO-->
                                    <td name='tb_afect'>
                                        <span
                                            t-esc="line.amount_untaxed"
                                            t-options='{"widget": "monetary", "display_currency": line.company_currency_id}'
                                        />
                                    </td>
                                    
                                    <!-- EXENTO-->
                                    <td name='tb_exent'>
                                        <span
                                            t-esc="line.amount_tax"
                                            t-options='{"widget": "monetary", "display_currency": line.company_currency_id}'
                                        />
                                    </td>
                                    
                                    <!-- TOTAL-->
                                    <td name='tb_total'>
                                        <span
                                            t-esc="line.amount_total"
                                            t-options='{"widget": "monetary", "display_currency": line.company_currency_id}'
                                        />
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                        
                    </table>
                    
                </div>
            
            </div>
        </t>
        
    </template>

    <template id="report_journal_entries">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="registro">
                <t
                    t-call="libro_compras.report_journal_entry_document"
                    t-lang="registro.user_id.lang"
                />
            </t>
        </t>
    </template>

    <record id="action_report_journal_entries" model="ir.actions.report">
        <field name="name">Custom Libro de compras</field>
        <field name="model">account.move</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">libro_compras.report_journal_entries</field>
        <field name="report_file">libro_compras.report_journal_entries</field>
        <field name="binding_model_id" ref="account.model_account_move" />
        <field name="binding_view_types">list,form</field>
    </record>
</odoo>
